"use strict";(self.webpackChunkfrontend_contrader=self.webpackChunkfrontend_contrader||[]).push([[158],{7158:(k,h,i)=>{i.r(h),i.d(h,{default:()=>N});var g=i(2651),t=i(5879),u=i(2296),C=i(617),p=i(7988),d=i(1274),m=i(6814),f=i(1896),_=i(3076),M=i(1522),y=i(6975);function O(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.accediButtonClick())}),t._uU(1,"ACCEDI"),t.qZA()}}function T(r,c){if(1&r&&t._UZ(0,"img",19),2&r){const a=t.oxw(2);t.Q6J("src",a.imageData,t.LSH)}}function P(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"p"),t.YNc(4,T,1,1,"img",14),t._uU(5),t.qZA()()(),t.TgZ(6,"span"),t._uU(7),t.qZA(),t.TgZ(8,"button",15)(9,"mat-icon"),t._uU(10,"expand_more"),t.qZA()(),t.TgZ(11,"mat-menu",16,17)(13,"button",18),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.matMenuMyProfileClickEvent())}),t.TgZ(14,"mat-icon"),t._uU(15,"face"),t.qZA(),t._uU(16," MyProfile "),t.qZA(),t.TgZ(17,"button",18),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.doLogout())}),t.TgZ(18,"mat-icon"),t._uU(19,"logout"),t.qZA(),t._uU(20," Logout "),t.qZA()()()}if(2&r){const a=t.MAs(12),e=t.oxw();t.Q6J("matMenuTriggerFor",a),t.xp6(4),t.Q6J("ngIf",""!==e.imageData),t.xp6(1),t.hij(" ",e.userinfo.name[0]+e.userinfo.lastname[0]," "),t.xp6(2),t.AsE(" ",e.userinfo.name," ",e.userinfo.lastname," ")}}let Z=(()=>{var r;class c{constructor(e,o,n,s){this.router=e,this.userService=o,this.utentiService=n,this.profileUpdateService=s,this.localStorage=localStorage,this.isLogged=!1,this.username="",this.imageData="",this.userinfo={address:"",city:"",date:"",genderType:"",id:0,lastname:"",name:"",nation:"",province:""},this.cartClickEvent=new t.vpe}matMenuMyProfileClickEvent(){this.router.navigate(["/user/profile/"])}doLogout(){localStorage.clear(),sessionStorage.clear(),this.router.navigate(["/login"])}cartClick(){console.log("cart clicked"),this.cartClickEvent.emit()}logoClickEvent(){this.router.navigate(["/user/lista"])}ngOnInit(){const e=localStorage.getItem("loggato");e&&(this.isLogged=JSON.parse(e));let o=localStorage.getItem("userSession");if(o){var n=JSON.parse(o);this.username=n.username,this.userinfo=n.userInfo;var s=n.id}this.readUser(s),this.profileUpdateService.onProfileUpdated().subscribe({next:()=>{this.readUser(s)}})}readUser(e){this.utentiService.readUser(e).subscribe({next:o=>{null!==o.image&&(this.imageData=o.image.data),this.username=o.username,this.userinfo=o.userInfoDTO}})}accediButtonClick(){this.router.navigate(["/login"])}}return(r=c).\u0275fac=function(e){return new(e||r)(t.Y36(f.F0),t.Y36(_.K),t.Y36(M.p),t.Y36(y.x))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-navbar"]],outputs:{cartClickEvent:"cartClickEvent"},standalone:!0,features:[t.jDz],decls:12,vars:2,consts:[[1,"calc-width"],["color","accent"],[3,"click"],["src","../../../../../assets/images/television_app_logo.svg",2,"width","120px","height","60px"],[1,"example-spacer"],[1,"mr-12"],[1,"flex-items"],[1,"material-icons",2,"margin-right","25px","cursor","pointer","user-select","none",3,"click"],["mat-raised-button","","color","primary","style","background-color: #a6039b",3,"click",4,"ngIf"],["class","flex-items",3,"matMenuTriggerFor",4,"ngIf"],["mat-raised-button","","color","primary",2,"background-color","#a6039b",3,"click"],[1,"flex-items",3,"matMenuTriggerFor"],[1,"round-img-profile"],[1,"profile-avatar"],["style","height: 100%; width: 100%;","alt","",3,"src",4,"ngIf"],["mat-icon-button","",1,"example-icon"],[1,"only-width","account-menu"],["menu","matMenu"],["mat-menu-item","",3,"click"],["alt","",2,"height","100%","width","100%",3,"src"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"mat-toolbar-row")(3,"figure",2),t.NdJ("click",function(){return o.logoClickEvent()}),t._UZ(4,"img",3),t.qZA(),t._UZ(5,"span",4)(6,"div",5),t.TgZ(7,"div",6)(8,"i",7),t.NdJ("click",function(){return o.cartClick()}),t._uU(9,"shopping_cart"),t.qZA(),t.YNc(10,O,2,0,"button",8),t.YNc(11,P,21,5,"div",9),t.qZA()()()()),2&e&&(t.xp6(10),t.Q6J("ngIf",!o.isLogged),t.xp6(1),t.Q6J("ngIf",o.isLogged))},dependencies:[m.ez,m.O5,u.ot,u.lW,u.RK,C.Ps,C.Hw,p.Tx,p.VK,p.OP,p.p6,d.g0,d.Ye,d.rD],styles:["mat-toolbar[_ngcontent-%COMP%]{background-color:#0360d9}mat-toolbar[_ngcontent-%COMP%]   mat-toolbar-row[_ngcontent-%COMP%]   .notification-icon[_ngcontent-%COMP%]{margin-right:24px;cursor:pointer}mat-toolbar[_ngcontent-%COMP%]   mat-toolbar-row[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{cursor:pointer;height:64px}mat-toolbar[_ngcontent-%COMP%]   .example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]   .round-img-profile[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;margin-right:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:#47caff}mat-toolbar[_ngcontent-%COMP%]   .round-img-profile[_ngcontent-%COMP%]   .profile-image[_ngcontent-%COMP%]{max-width:100%;object-fit:cover}mat-toolbar[_ngcontent-%COMP%]   .round-img-profile[_ngcontent-%COMP%]   .profile-avatar[_ngcontent-%COMP%]{color:#fff;font-size:18px;height:100%;width:100%;object-fit:cover;object-position:center;font-weight:500;display:flex;justify-content:center;align-items:center}mat-toolbar[_ngcontent-%COMP%]   .round-img-profile[_ngcontent-%COMP%]   .profile-avatar[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}mat-toolbar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px}.secondary-row[_ngcontent-%COMP%]{background-color:#f3f3f3;height:125px;padding:0 24px}.secondary-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.secondary-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .secondary-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#0a4a89;margin-bottom:0;cursor:pointer}.flex-items[_ngcontent-%COMP%]{display:flex;align-items:center;width:-moz-fit-content;width:fit-content}.calc-width[_ngcontent-%COMP%]{width:100%;margin:0}.title-content[_ngcontent-%COMP%]{color:#0a4a89;font-size:32px;font-weight:700;margin-top:12px}figure[_ngcontent-%COMP%]{display:flex;align-items:center}"]}),c})();var b=i(6385),x=i(6025),U=i(3601);const A=["drawer"];function w(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"div",16)(1,"div",17),t._UZ(2,"img",18),t.TgZ(3,"div",19)(4,"h5"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7,"Orario 00/00/0000 - 00:00"),t.qZA()(),t.TgZ(8,"div",20)(9,"p"),t._uU(10),t.qZA(),t.TgZ(11,"i",21),t.NdJ("click",function(){const n=t.CHM(a).$implicit,s=t.oxw();return t.KtG(s.deleteItemCart(n.id))}),t._uU(12,"delete"),t.qZA()()(),t._UZ(13,"mat-divider"),t.qZA()}if(2&r){const a=c.$implicit;t.xp6(2),t.s9C("src",a.images[0].data,t.LSH),t.xp6(3),t.Oqu(a.name),t.xp6(5),t.hij("",a.price," \u20ac")}}let N=(()=>{var r;class c{constructor(e,o,n,s,v){this.userService=e,this.route=o,this.cartCommunicationService=n,this.orderService=s,this.notificationService=v,this.prodotti=[],this.cartProductsMap=new Map,this.cartTotal=0,this.Array=Array}cartButtonContinueNavigation(){this.drawer.opened=!1,this.route.navigate(["/user/lista"])}cartButtonConfirmOrder(){this.drawer.opened=!1;var e=[];if(this.cartProductsMap.forEach(l=>{e.push(l)}),this.cartProductsMap.size>0){var o=localStorage.getItem("userSession");if(o)var s=JSON.parse(o).id;this.orderService.insertOrder(s,{id:0,products:e}).subscribe({next:l=>{console.log(l),this.cartProductsMap.clear(),this.route.navigate(["/user/acquisto/"+l.id]),this.cartTotal=0},error:l=>{console.log(l)},complete:()=>{}})}else this.notificationService.show("Carrello vuoto!",2500,"error")}openCart(){console.log("toggling drawer"),this.drawer.toggle()}deleteItemCart(e){this.cartProductsMap.has(e)&&(this.cartTotal-=Number(this.cartProductsMap.get(e).price),this.cartProductsMap.delete(e),this.saveCartMapToLocalStorage())}saveCartMapToLocalStorage(){const e=Array.from(this.cartProductsMap.entries()),o=JSON.stringify(e);localStorage.setItem("cart",o)}ngOnInit(){let e=localStorage.getItem("cart");const o=JSON.parse(e);this.cartProductsMap=new Map(o);for(let n of Array.from(this.cartProductsMap.values()))this.cartTotal+=Number(n.price);this.cartCommunicationService.addToCart.subscribe({next:n=>{this.cartProductsMap.has(n.id)||(this.cartProductsMap.set(n.id,n),console.log("id to add to cart: "+n),this.cartTotal+=n.price,this.saveCartMapToLocalStorage()),this.drawer.toggle()},error:n=>{},complete:()=>{}}),this.userService.getAllProducts().subscribe({next:n=>{this.prodotti=n},error:n=>{},complete:()=>{}})}}return(r=c).\u0275fac=function(e){return new(e||r)(t.Y36(_.K),t.Y36(f.F0),t.Y36(x.uO),t.Y36(U.p),t.Y36(x.gq))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-user-layout"]],viewQuery:function(e,o){if(1&e&&t.Gf(A,5),2&e){let n;t.iGM(n=t.CRH())&&(o.drawer=n.first)}},standalone:!0,features:[t.jDz],decls:28,vars:4,consts:[[3,"cartClickEvent"],["autosize","",1,"example-container",3,"hasBackdrop"],["mode","over","position","end",1,"example-sidenav"],["drawer",""],[1,"cart-container",2,"max-height","85vh","overflow-y","auto"],[1,"top-cart-container"],["class","items-container",4,"ngFor","ngForOf"],[1,"bottom-cart-container"],[1,"price"],[1,"cont1",2,"display","flex","justify-content","space-between","margin","5px"],[2,"color","#cccccc"],[1,"cont2",2,"display","flex","justify-content","space-between","margin","5px"],["mat-raised-button","","color","primary",2,"background-color","#a6039b",3,"click"],["mat-stroked-button","","color","primary",2,"border-color","#1d53bc",3,"click"],[2,"max-height","100vh","overflow-y","auto"],[2,"height","100%","width","100%"],[1,"items-container"],[1,"item-card-cart",2,"display","flex","padding","10px","justify-content","space-between"],[2,"height","64px","width","64px","background-color","#1d53bc","object-fit","cover","object-position","center",3,"src"],[1,"item-card-description",2,"padding","5px"],[1,"prova"],[1,"material-icons",2,"cursor","pointer","user-select","none","display","inline-flex","justify-content","end","width","100%",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"app-navbar",0),t.NdJ("cartClickEvent",function(){return o.openCart()}),t.qZA(),t.TgZ(1,"mat-sidenav-container",1)(2,"mat-sidenav",2,3)(4,"div",4)(5,"div",5)(6,"h4"),t._uU(7,"Carrello"),t.qZA(),t.YNc(8,w,14,3,"div",6),t.qZA(),t.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"p",10),t._uU(13,"Sub Totale: "),t.qZA(),t.TgZ(14,"p",10),t._uU(15),t.qZA()(),t.TgZ(16,"div",11)(17,"p"),t._uU(18,"Totale: "),t.qZA(),t.TgZ(19,"p"),t._uU(20),t.qZA()()(),t.TgZ(21,"button",12),t.NdJ("click",function(){return o.cartButtonConfirmOrder()}),t._uU(22,"CONCLUDI ORDINE"),t.qZA(),t.TgZ(23,"button",13),t.NdJ("click",function(){return o.cartButtonContinueNavigation()}),t._uU(24,"CONTINUA A NAVIGARE"),t.qZA()()()(),t.TgZ(25,"mat-sidenav-content",14)(26,"div",15),t._UZ(27,"router-outlet"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("hasBackdrop",!0),t.xp6(7),t.Q6J("ngForOf",o.Array.from(o.cartProductsMap.values())),t.xp6(7),t.hij(" ",o.cartTotal," \u20ac"),t.xp6(5),t.hij(" ",o.cartTotal," \u20ac"))},dependencies:[Z,g.SJ,g.JX,g.TM,g.Rh,b.t,b.d,u.ot,u.lW,f.lC,m.sg],styles:[".cart-container[_ngcontent-%COMP%]{width:350px;position:static;height:100%;display:flex;flex-direction:column;justify-content:space-between;margin:30px}.bottom-cart-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.bottom-cart-container[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin:8px}"]}),c})()}}]);