"use strict";(self.webpackChunkfrontend_contrader=self.webpackChunkfrontend_contrader||[]).push([[973],{7973:(P,h,s)=>{s.r(h),s.d(h,{default:()=>I});var u=s(6814),a=s(3302),D=s(9623),U=s(515),g=s(5313),m=s(1081),f=s(3149),e=s(5879),C=s(6025),v=s(1522),E=s(1896),M=s(7700);function O(o,r){if(1&o){const n=e.EpF();e.ynx(0),e.TgZ(1,"app-generic-table",3),e.NdJ("emitChangePage",function(t){e.CHM(n);const l=e.oxw();return e.KtG(l.changePage(t))})("emitApplicaAzioniDiGruppo",function(t){e.CHM(n);const l=e.oxw();return e.KtG(l.applicaAzioniDiGruppo(t))}),e.qZA(),e.BQk()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("pageIndex",n.pageIndex)("size",n.size)("totalElements",n.totalElements)("hasGroupActions",n.hasGroupActions)("dataSource",n.dataSource)("displayedColumns",n.displayedColumns)("cellHeadTypes",n.cellHeadTypes)("hasSearch",!1)("hasSelect",!1)}}function x(o,r){if(1&o&&(e.TgZ(0,"div",4)(1,"span"),e._uU(2),e.ALo(3,"uppercase"),e.qZA()()),2&o){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,n.resultConstant.nessun_risultato))}}let I=(()=>{var o;class r{constructor(i,t,l,d,p,c){this.genericTableService=i,this.loaderSpinnerService=t,this.utentiService=l,this.activatedRoute=d,this.dialog=p,this.router=c,this.resultConstant=a.qA,this.size=a.aq.pageSize,this.pageIndex=a.aq.pageNumber,this.displayedColumns=a.Z0.utenti,this.cellHeadTypes={select:"checkbox",full_name:"sort",username:"sort",gender:"sort",date:"sort"},this.sortedItems={full_name:!1,username:!1,gender:!1,date:!1},this.listaUtenti=[]}ngOnInit(){this.hasGroupActions=!0,this.changePage()}getDataFromResolver(){this.totalElements=this.activatedRoute.snapshot.data.listaUtenti.totalElements,this.pageIndex=this.activatedRoute.snapshot.data.listaUtenti.pageIndex,this.listaUtenti=this.activatedRoute.snapshot.data.listaUtenti,this.listaUtenti&&(this.dataSource=new g.by(this.getMappedDataSource(this.listaUtenti)))}sortCol(){}changePage(i){this.loaderSpinnerService.show(),this.utentiService.getListaUtenti(this.size,this.pageIndex).subscribe({next:t=>{this.totalElements=t.length,this.pageIndex=i?i.number:0,t&&(this.listaUtenti=t,this.dataSource=new g.by(this.getMappedDataSource(this.listaUtenti.slice(this.pageIndex*this.size,(this.pageIndex+1)*this.size)))),this.genericTableService.emitFilteringStatus(!1),this.loaderSpinnerService.hide()},error:()=>this.loaderSpinnerService.hide()})}applicaAzioniDiGruppo(i){"Elimina"==i.azione&&this.eliminaUtenti(i.selected)}getMappedDataSource(i){return i.map(t=>{const l=[{title:a.$I.visualizza,icon:a.fb.view,type:"icon",callback:()=>this.visualizzaUtente(t.id)},{title:a.$I.modifica,icon:a.fb.edit,type:"icon",callback:()=>this.modificaUtente(t.id)},{title:a.$I.elimina,icon:a.fb.delete,type:"icon",callback:()=>this.eliminaUtente(t.id)}];return{full_name:t.userInfoDTO.name+" "+t.userInfoDTO.lastname,mail:t.username,gender:t.userInfoDTO.genderType.charAt(0)+t.userInfoDTO.genderType.substring(1).toLowerCase(),date:new Date(Date.parse(t.userInfoDTO.date)).toLocaleDateString("it-EU"),id:t.id,select:!1,username:t.username,usertype:t.usertype,action:l}})}modificaUtente(i){this.router.navigate(["/gestionale/utenti/edituser/",i],{state:{id:i}})}visualizzaUtente(i){this.router.navigate(["/gestionale/utenti/userview/",i],{state:{id:i}})}eliminaUtente(i){this.dialog.open(m.g,{width:"660px",height:"300px",disableClose:!0,data:a.sD.cancella_utente}).afterClosed().subscribe(l=>{l&&this.utentiService.deleteUser(i).subscribe(d=>{this.dialog.open(f.t,{width:"660px",height:"300px",disableClose:!0,data:{title:a.cm.delete_successful,body:a.cm.delete_successful2}}).afterClosed().subscribe(()=>{location.reload()})})})}eliminaUtenti(i){let t=i.length;this.dialog.open(m.g,{width:"660px",height:"300px",disableClose:!0,data:a.sD.cancella_utenti1+t+a.sD.cancella_utenti2}).afterClosed().subscribe(d=>{if(d){for(let _=0;_<t;_++)this.utentiService.deleteUser(i[_].id).subscribe(y=>{});let c={title:"",body:""};c=1!=t?{title:a.cm.delete_successfulMany,body:a.cm.delete_successfulMany2+t+a.cm.delete_successfulMany3}:{title:a.cm.delete_successful,body:a.cm.delete_successful2},this.dialog.open(f.t,{width:"660px",height:"300px",disableClose:!0,data:c}).afterClosed().subscribe(()=>{location.reload()})}})}}return(o=r).\u0275fac=function(i){return new(i||o)(e.Y36(C.pZ),e.Y36(C.QU),e.Y36(v.p),e.Y36(E.gz),e.Y36(M.uw),e.Y36(E.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-lista-utenti"]],standalone:!0,features:[e.jDz],decls:4,vars:2,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["noResult",""],[3,"pageIndex","size","totalElements","hasGroupActions","dataSource","displayedColumns","cellHeadTypes","hasSearch","hasSelect","emitChangePage","emitApplicaAzioniDiGruppo"],[1,"body","mt-24"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,O,2,9,"ng-container",1),e.YNc(2,x,4,3,"ng-template",null,2,e.W1O),e.qZA()),2&i){const l=e.MAs(3);e.xp6(1),e.Q6J("ngIf",null==t.dataSource||null==t.dataSource.data?null:t.dataSource.data.length)("ngIfElse",l)}},dependencies:[u.ez,u.O5,u.gd,D.hd,U.p],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:2px;background-color:#fff;border-radius:8px}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.938rem;font-weight:700;color:#656d70;line-height:15px;text-decoration:none}"]}),r})()}}]);