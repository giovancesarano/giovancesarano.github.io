"use strict";(self.webpackChunkfrontend_contrader=self.webpackChunkfrontend_contrader||[]).push([[381],{3381:(G,v,r)=>{r.r(v),r.d(v,{default:()=>w});var c=r(1896),i=r(6223),g=r(2296),x=r(1545),p=r(9157),Z=r(2032),T=r(6385),A=r(5986),C=r(617),b=r(8525),d=r(8034),U=r(6814),I=r(5940),y=r(3149),l=r(3302),P=r(7914),e=r(5879),M=r(7700),q=r(1522),O=r(6025),E=r(3680);const D=["fileInput"];function F(s,_){if(1&s&&(e.TgZ(0,"div"),e._UZ(1,"br")(2,"br"),e.TgZ(3,"form",11)(4,"div",0)(5,"p",27),e._uU(6),e.qZA()(),e.TgZ(7,"div",0)(8,"p",12),e._uU(9,"Informazioni Azienda"),e.qZA()(),e.TgZ(10,"div",0)(11,"mat-form-field",13)(12,"mat-label"),e._uU(13,"Nome"),e.qZA(),e._UZ(14,"input",37),e.qZA(),e._UZ(15,"mat-label",38),e.qZA(),e.TgZ(16,"div",0)(17,"mat-form-field",13)(18,"mat-label"),e._uU(19,"Indirizzo"),e.qZA(),e._UZ(20,"input",39),e.qZA(),e.TgZ(21,"mat-form-field",13)(22,"mat-label"),e._uU(23,"Provincia"),e.qZA(),e._UZ(24,"input",40),e.qZA(),e.TgZ(25,"mat-form-field",13)(26,"mat-label"),e._uU(27,"Citt\xe0"),e.qZA(),e._UZ(28,"input",41),e.qZA()(),e.TgZ(29,"div",0)(30,"mat-form-field",42)(31,"mat-label"),e._uU(32,"Descrizione"),e.qZA(),e._UZ(33,"textarea",43),e.qZA()(),e.TgZ(34,"div",0)(35,"p",26),e._uU(36),e.qZA()()()()),2&s){const u=e.oxw();e.xp6(3),e.Q6J("formGroup",u.FormGroup2),e.xp6(3),e.Oqu(u.log2),e.xp6(30),e.Oqu(u.INPUT_CONSTANT.campi_obbligatori)}}let w=(()=>{var s;class _{constructor(a,t,o,n,f,m,h){this.router=a,this.route=t,this._formBuilder=o,this.dialog=n,this.utentiService=f,this.loginService=m,this.signupService=h,this.errorsConstant=l.sm,this.FormGroup=this._formBuilder.group({email:["",[i.kI.required,i.kI.pattern(/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/),i.kI.minLength(3),i.kI.maxLength(128)]],password:["",[i.kI.required,i.kI.minLength(8),i.kI.maxLength(64)]],password2:["",[i.kI.required,i.kI.minLength(8),i.kI.maxLength(64)]],firstCtrl:[!1],usertype:["user",i.kI.required],checkbox:[!0,i.kI.requiredTrue],secondCtrl:[!1],firstname:["",[i.kI.required]],lastname:["",[i.kI.required]],birthday:["",[i.kI.required]],genre:["man",[i.kI.required]],nation:["",[i.kI.required]],province:["",[i.kI.required]],city:["",[i.kI.required]],address:["",[i.kI.required]],thirdCtrl:[!1]},{validator:P.R.MatchPassword}),this.FormGroup2=this._formBuilder.group({factory_name:["",[i.kI.required]],factory_description:["",[i.kI.required]],factory_province:["",[i.kI.required]],factory_city:["",[i.kI.required]],factory_address:["",[i.kI.required]]}),this.imageData="",this.isOptional=!1,this.hide=!0,this.isLastButtonDisabled=!1,this.isUserSignup=!0,this.apiLoading=!1,this.checkBoxSelected=!1,this.log="",this.log2="",this.INPUT_CONSTANT=l.aq,this.ERRORS_CONSTANT=l.sm}ngOnInit(){}goToUsers(){this.router.navigate(["/gestionale/utenti"])}onUsertypeChanged(a){"user"==a.value?this.isUserSignup=!0:"admin"==a.value&&(this.isUserSignup=!1)}openFileInput(){this.fileInput.nativeElement.click()}onFileSelected(a){const t=a.target.files;if(t.length>0){const o=t[0];let n=new FileReader;n.readAsDataURL(o),n.onload=()=>{this.imageData=n.result}}}register(){this.isLastButtonDisabled=!0,this.apiLoading=!0;let a={email:this.FormGroup.value.email,usertype:this.FormGroup.value.usertype,password:this.FormGroup.value.password,lastname:this.FormGroup.value.lastname,firstname:this.FormGroup.value.firstname,birthday:this.FormGroup.value.birthday,genre:this.FormGroup.value.genre,nation:this.FormGroup.value.nation,province:this.FormGroup.value.province,city:this.FormGroup.value.city,address:this.FormGroup.value.address,factory_name:this.FormGroup2.value.factory_name,factory_description:this.FormGroup2.value.factory_description,factory_province:this.FormGroup2.value.factory_province,factory_city:this.FormGroup2.value.factory_city,factory_address:this.FormGroup2.value.factory_address};this.FormGroup.valid&&(this.FormGroup2.valid||this.isUserSignup)?(this.log=this.log2="",this.signupService.checkEmail(a.email).subscribe({next:t=>{t&&(this.log="Email gi\xe0 in uso"),this.isUserSignup?this.log==this.log2?this.signupService.signup(a).subscribe({next:o=>{this.dialog.open(y.t,{width:"660px",height:"300px",disableClose:!0,data:{title:l.cm.insert_successful,body:l.cm.insert_successful2}}).afterClosed().subscribe(()=>{this.goToUsers()})},error:o=>{console.log(o),console.error(`Error: ${o.message}`),this.isLastButtonDisabled=!1,this.apiLoading=!1},complete:()=>{console.log("Observable complete")}}):(this.isLastButtonDisabled=!1,this.apiLoading=!1):this.signupService.signup(a).subscribe({next:o=>{this.loginService.login({username:this.FormGroup.value.email,password:this.FormGroup.value.password,rememberMe:!1}).subscribe({next:f=>{this.utentiService.readUser(f.id).subscribe({next:m=>{let h={id:m.id,factory_id:m.factoryDTO.id,userinfo_id:m.userInfoDTO.id,cart_id:m.cart.id,email:this.FormGroup.value.email,usertype:this.FormGroup.value.usertype?.toUpperCase(),password:this.FormGroup.value.password,lastname:this.FormGroup.value.lastname,firstname:this.FormGroup.value.firstname,birthday:this.FormGroup.value.birthday,genre:this.FormGroup.value.genre,nation:this.FormGroup.value.nation,province:this.FormGroup.value.province,city:this.FormGroup.value.city,address:this.FormGroup.value.address,factory_name:this.FormGroup2.value.factory_name,factory_description:this.FormGroup2.value.factory_description,factory_province:this.FormGroup2.value.factory_province,factory_city:this.FormGroup2.value.factory_city,factory_address:this.FormGroup2.value.factory_address,image:{id:m.id,data:this.imageData}};this.signupService.update(h).subscribe({next:L=>{this.dialog.open(y.t,{width:"660px",height:"300px",disableClose:!0,data:{title:l.cm.insert_successful,body:l.cm.insert_successful2}}).afterClosed().subscribe(()=>{this.goToUsers()})}})}})}})},error:o=>{console.log(o),console.error(`Error: ${o.message}`),this.isLastButtonDisabled=!1,this.apiLoading=!1},complete:()=>{console.log("Observable complete")}})}})):(this.apiLoading=!1,this.isLastButtonDisabled=!1)}}return(s=_).\u0275fac=function(a){return new(a||s)(e.Y36(c.F0),e.Y36(c.gz),e.Y36(i.qu),e.Y36(M.uw),e.Y36(q.p),e.Y36(O.r6),e.Y36(O.Or))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-inserisci-utente"]],viewQuery:function(a,t){if(1&a&&e.Gf(D,5),2&a){let o;e.iGM(o=e.CRH())&&(t.fileInput=o.first)}},standalone:!0,features:[e.jDz],decls:109,vars:18,consts:[[1,"container2"],[1,"compX",2,"position","relative"],[2,"width","64px","height","64px","border-radius","32px","object-fit","cover","object-position","center",3,"src"],["type","file",2,"display","none",3,"change"],["fileInput",""],[2,"border-radius","50%","width","28px","height","28px","background-color","#a6039b","bottom","4px","right","-8px","position","absolute","display","flex","align-items","center","justify-content","center","cursor","pointer",3,"click"],[2,"color","white","font-size","15px","width","fit-content","height","fit-content"],[1,"comp2",2,"padding-left","15px"],[1,"comp4"],[1,"button-confirm-container"],["mat-raised-button","",2,"padding-right","80px","padding-left","80px","background-color","#a6039b","color","white","float","right",3,"click"],[3,"formGroup"],[1,"p"],["appearance","outline",2,"flex-grow","1","padding-right","10px"],["matInput","","formControlName","lastname","name","lastname","required","","maxlength","255"],["matInput","","formControlName","firstname","name","firstname","required","","maxlength","255"],["formControlName","genre"],["value","man"],["value","woman"],["matInput","","formControlName","birthday","placeholder","Scegli data",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","nation","required","","maxlength","255"],["matInput","","formControlName","province","required","","maxlength","2"],["matInput","","formControlName","city","required","","maxlength","255"],["matInput","","formControlName","address","required","","maxlength","255"],[1,"p3"],[1,"error"],["appearance","outline",2,"flex-grow","1","padding-right","10px","width","700px"],["matInput","","formControlName","email","name","email","required","","maxlength","128"],["formControlName","usertype",3,"selectionChange"],["value","user"],["value","admin"],["name","password","matInput","","formControlName","password","required","","maxlength","64",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["name","password2","matInput","","formControlName","password2","required","","maxlength","64",3,"type"],[4,"ngIf"],["matInput","","formControlName","factory_name","required","","maxlength","255"],[2,"flex-grow","1","padding-right","220px"],["matInput","","formControlName","factory_address","required","","maxlength","255"],["matInput","","formControlName","factory_province","required","","maxlength","2"],["matInput","","formControlName","factory_city","required","","maxlength","255"],["appearance","outline",1,"example-full-width",2,"flex-grow","1","padding-right","10px","width","1400px","max-height","173px","min-height","173px"],["matInput","","required","","formControlName","factory_description","rows","7",2,"resize","none"]],template:function(a,t){if(1&a&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"img",2),e.TgZ(3,"input",3,4),e.NdJ("change",function(n){return t.onFileSelected(n)}),e.qZA(),e.TgZ(5,"div",5),e.NdJ("click",function(){return t.openFileInput()}),e.TgZ(6,"mat-icon",6),e._uU(7,"edit"),e.qZA()()(),e.TgZ(8,"div",7)(9,"h3"),e._uU(10,"Nuovo Utente"),e.qZA()(),e.TgZ(11,"div",8)(12,"div",9)(13,"button",10),e.NdJ("click",function(){return t.register()}),e._uU(14,"SALVA"),e.qZA()()()(),e._UZ(15,"br")(16,"br"),e.TgZ(17,"form",11)(18,"div",0)(19,"p",12),e._uU(20,"Informazioni Generali"),e.qZA()(),e.TgZ(21,"div",0)(22,"mat-form-field",13)(23,"mat-label"),e._uU(24,"Cognome"),e.qZA(),e._UZ(25,"input",14),e.qZA(),e.TgZ(26,"mat-form-field",13)(27,"mat-label"),e._uU(28,"Nome"),e.qZA(),e._UZ(29,"input",15),e.qZA()(),e.TgZ(30,"div",0)(31,"mat-form-field",13)(32,"mat-label"),e._uU(33,"Genere"),e.qZA(),e.TgZ(34,"mat-select",16)(35,"mat-option",17),e._uU(36,"Uomo"),e.qZA(),e.TgZ(37,"mat-option",18),e._uU(38,"Donna"),e.qZA()()(),e.TgZ(39,"mat-form-field",13)(40,"mat-label"),e._uU(41,"Data"),e.qZA(),e._UZ(42,"input",19)(43,"mat-datepicker-toggle",20)(44,"mat-datepicker",null,21),e.qZA()(),e.TgZ(46,"div",0)(47,"mat-form-field",13)(48,"mat-label"),e._uU(49,"Nazione"),e.qZA(),e._UZ(50,"input",22),e.qZA(),e.TgZ(51,"mat-form-field",13)(52,"mat-label"),e._uU(53,"Provincia"),e.qZA(),e._UZ(54,"input",23),e.qZA(),e.TgZ(55,"mat-form-field",13)(56,"mat-label"),e._uU(57,"Citt\xe0"),e.qZA(),e._UZ(58,"input",24),e.qZA(),e.TgZ(59,"mat-form-field",13)(60,"mat-label"),e._uU(61,"Indirizzo"),e.qZA(),e._UZ(62,"input",25),e.qZA()(),e.TgZ(63,"div",0)(64,"p",26),e._uU(65),e.qZA()(),e._UZ(66,"br")(67,"br"),e.TgZ(68,"div",0)(69,"p",27),e._uU(70),e.qZA()(),e.TgZ(71,"div",0)(72,"p",12),e._uU(73,"Informazioni Accesso"),e.qZA()(),e.TgZ(74,"div",0)(75,"mat-form-field",28)(76,"mat-label"),e._uU(77,"Email"),e.qZA(),e._UZ(78,"input",29),e.TgZ(79,"mat-error"),e._uU(80),e.qZA()(),e.TgZ(81,"mat-form-field",28)(82,"mat-label"),e._uU(83,"Tipologia Utente"),e.qZA(),e.TgZ(84,"mat-select",30),e.NdJ("selectionChange",function(n){return t.onUsertypeChanged(n)}),e.TgZ(85,"mat-option",31),e._uU(86,"User"),e.qZA(),e.TgZ(87,"mat-option",32),e._uU(88,"Admin"),e.qZA()()()(),e.TgZ(89,"div",0)(90,"mat-form-field",13)(91,"mat-label"),e._uU(92,"Password"),e.qZA(),e._UZ(93,"input",33),e.TgZ(94,"button",34),e.NdJ("click",function(){return t.hide=!t.hide}),e.TgZ(95,"mat-icon"),e._uU(96),e.qZA()(),e.TgZ(97,"mat-error"),e._uU(98),e.qZA()(),e.TgZ(99,"mat-form-field",13)(100,"mat-label"),e._uU(101,"Conferma password"),e.qZA(),e._UZ(102,"input",35),e.TgZ(103,"button",34),e.NdJ("click",function(){return t.hide=!t.hide}),e.TgZ(104,"mat-icon"),e._uU(105),e.qZA()(),e.TgZ(106,"mat-error"),e._uU(107),e.qZA()()()(),e.YNc(108,F,37,3,"div",36)),2&a){const o=e.MAs(45);e.xp6(2),e.Q6J("src",t.imageData,e.LSH),e.xp6(15),e.Q6J("formGroup",t.FormGroup),e.xp6(25),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o),e.xp6(22),e.Oqu(t.INPUT_CONSTANT.campi_obbligatori),e.xp6(5),e.Oqu(t.log),e.xp6(10),e.Oqu(t.FormGroup.controls.email.hasError("pattern")?t.errorsConstant.input.email_pattern:""===t.FormGroup.controls.email.value?t.errorsConstant.required:t.FormGroup.controls.email.hasError("minlength")?t.errorsConstant.input.min_length_3:t.errorsConstant.input.max_length_128),e.xp6(13),e.Q6J("type",t.hide?"password":"text"),e.xp6(1),e.uIk("aria-label","Hide password")("aria-pressed",t.hide),e.xp6(2),e.Oqu(t.hide?"visibility_off":"visibility"),e.xp6(2),e.Oqu(""===t.FormGroup.controls.password.value?"Campo obbligatorio":t.FormGroup.controls.password.hasError("minlength")?"Almeno 8 caratteri":""),e.xp6(4),e.Q6J("type",t.hide?"password":"text"),e.xp6(1),e.uIk("aria-label","Hide password")("aria-pressed",t.hide),e.xp6(2),e.Oqu(t.hide?"visibility_off":"visibility"),e.xp6(2),e.Oqu(t.FormGroup.controls.password2.hasError("passwordMismatch")?"Le password devono coincidere":""),e.xp6(1),e.Q6J("ngIf",!t.isUserSignup)}},dependencies:[U.ez,U.O5,c.Bz,g.ot,g.lW,g.RK,x.T5,i.u5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.nD,i.UX,i.sg,i.u,p.lN,p.KE,p.hX,p.TO,p.R9,T.t,Z.c,Z.Nt,A.p9,C.Ps,C.Hw,b.LD,b.gD,E.ey,d.FA,d.Mq,d.hl,d.nW,I.Cq],styles:['.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;background-color:#0a4a89;background-size:cover;background-repeat:no-repeat;background-position:center center}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{height:10px!important}[_nghost-%COMP%]     .mat-mdc-form-field{margin:0!important}[_nghost-%COMP%]     .mat-stepper-horizontal-line{margin:-1!important;border-top-width:-1!important;border-top-style:solid;flex:none;height:19px!important;margin:0!important;min-width:0!important;border-top-color:transparent!important}[_nghost-%COMP%]     .mat-stepper-horizontal-line:before{content:">"}[_nghost-%COMP%]     .mat-step-icon-state-edit{background-color:#41cf0d}.styled-image[_ngcontent-%COMP%]{position:fixed;top:20px;left:20px;width:200px;height:130px;color:#fff}.form-cont[_ngcontent-%COMP%]{width:50%;padding:20px;border-radius:15px;background-color:#fff}.bottom-form-bar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:40px;margin-top:10px}.form-input-row[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;align-items:center;justify-content:space-between}.mat-stepper-horizontal[_ngcontent-%COMP%]{margin-top:8px}.mat-mdc-form-field[_ngcontent-%COMP%]{margin-top:16px}.container2[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;height:100%;padding:2px;background-color:#fff;border-radius:8px}.container2[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.container2[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.938rem;font-weight:700;color:#656d70;line-height:15px;text-decoration:none}.comp1[_ngcontent-%COMP%], .comp2[_ngcontent-%COMP%], .comp3[_ngcontent-%COMP%], .comp4[_ngcontent-%COMP%]{flex-grow:1}.compX[_ngcontent-%COMP%]{flex-grow:0}.p[_ngcontent-%COMP%]{color:#9b999d;font-weight:700}.p2[_ngcontent-%COMP%]{color:#9b999d}.p3[_ngcontent-%COMP%]{color:#9b999d;font-size:12px}.error[_ngcontent-%COMP%]{text-align:center;margin-bottom:16px;white-space:pre-line;font-size:1.5rem;font-weight:500;color:#d32f2f;line-height:19px}.round-img-profile[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;margin-right:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:#47caff}.flex-items[_ngcontent-%COMP%]{display:flex;align-items:center;width:-moz-fit-content;width:fit-content;color:#fff;font-size:24px;line-height:1;font-weight:500}']}),_})()}}]);